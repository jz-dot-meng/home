(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[470],{2802:function(e,l,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/music/recently-listened",function(){return n(3510)}])},3510:function(e,l,n){"use strict";n.r(l),n.d(l,{default:function(){return h}});var t=n(4246),s=function(e,l){var n=Math.floor((e-l)/1e3),t=Math.floor(n/86400),s=Math.floor((0===t?n:n-86400*t)/3600);return{dayElapsed:t,hourElapsed:s,minElapsed:Math.floor((0===t&&0===s?n:n-86400*t-3600*s)/60),secRemainder:n%60}},r=n(7378),a=n(3354),i=function(e){var l=e.track,n=(0,r.useMemo)(function(){var e;return"@attr"in l&&(null===(e=l["@attr"])||void 0===e?void 0:e.nowplaying)},[l]),i=(0,r.useMemo)(function(){if("date"in l)return s(Date.now(),1e3*Number(l.date.uts))},[l]);return(0,t.jsxs)("div",{className:"flex gap-1 py-2",children:[(0,t.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,t.jsx)("img",{src:l.image[2]["#text"],width:40,height:40,alt:"album-cover"})}),(0,t.jsxs)("a",{className:"flex-[2] flex-col flex justify-center",href:l.url,target:"_blank",children:[(0,t.jsx)("div",{children:l.name}),(0,t.jsx)("div",{className:"text-xs text-grey-300",children:l.album["#text"]})]}),(0,t.jsx)("div",{className:"flex-1 flex items-center text-xs md:text-base",children:l.artist.name}),(0,t.jsx)("div",{className:"flex-1 flex gap-2 text-grey-600 items-center text-xs md:text-base",children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.x,{}),(0,t.jsx)("div",{children:"Now playing"})]}):i?i.dayElapsed>0?"".concat(i.dayElapsed," day").concat(i.dayElapsed>1?"s":""," ago"):i.hourElapsed>0?"".concat(i.hourElapsed," hr").concat(i.hourElapsed>1?"s":""," ago"):"".concat(i.minElapsed," min ago"):""})]})},c=n(53),o=(0,r.forwardRef)(function(e,l){var n=e.children,s=e.itemsToShow,a=e.childrenLength,i=(0,c._)((0,r.useState)(0),2),o=i[0],d=i[1];(0,r.useEffect)(function(){d(a)},[a]);var f=(0,r.useMemo)(function(){return a>s},[a,s]),x=(0,c._)((0,r.useState)(!0),2),u=x[0],h=x[1];(0,r.useImperativeHandle)(l,function(){return{next:function(){return v()},prev:function(){return p()}}}),(0,r.useEffect)(function(){f&&!u&&(o>=a||o<=2*a-1)&&setTimeout(function(){return h(!0)},50)},[o,f,a]);var m=function(){f&&(0===o?(h(function(e){return!1}),d(a)):o===3*a-1&&(h(function(e){return!1}),d(2*a-1)))},v=function(){(f||o<a-s)&&d(function(e){return e+1})},p=function(){(f||o>0)&&d(function(e){return e-1})},j=(0,r.useMemo)(function(){return 3*a},[a]);return(0,t.jsx)("div",{className:"w-full overflow-hidden h-full",children:(0,t.jsxs)("div",{className:"flex no-scrollbar transition-all flex overflow-y-hidden h-full",style:{width:"calc(".concat(100*j,"%)"),transform:"translateX(".concat(-1*(100*o)/j,"%)"),transition:u?void 0:"none"},onTransitionEnd:function(){return m()},children:[n,n,n]})})});o.displayName="Carousel";var d=n(2210),f=n(9894),x=n.n(f),u=function(){var e=(0,d.q)(),l=e.weeklyTracks,n=e.weeklyArtists,s=e.latestTracks,a=(0,c._)((0,r.useState)([]),2),i=a[0],f=a[1];(0,r.useEffect)(function(){for(var e=[],n=0;e.length<4&&n<l.length;)!function(){var t=l[n],r=s.find(function(e){return e.name===t.name&&e.artist.name===t.artist["#text"]});r&&e.push({track:r,rank:t}),n++}();f(e)},[l,s]);var u=(0,r.useRef)(null),h=(0,r.useRef)(null),m=function(){var e,l;null===(e=u.current)||void 0===e||e.prev(),null===(l=h.current)||void 0===l||l.prev()},v=function(){var e,l;null===(e=u.current)||void 0===e||e.next(),null===(l=h.current)||void 0===l||l.next()};return(0,t.jsxs)("div",{className:"flex flex-col flex-1 gap-2 overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex border-b border-white p-2 text-sm",children:[(0,t.jsx)("div",{className:"pl-2 pr-2 md:pr-4 cursor-pointer",onClick:function(){return m()},children:"<"}),(0,t.jsx)("div",{className:"flex-1 px-2 md:px-4",children:(0,t.jsxs)(o,{itemsToShow:1,childrenLength:2,ref:u,children:[(0,t.jsx)("div",{className:"flex-1 text-right",children:"Top Tracks of the Week"}),(0,t.jsx)("div",{className:"flex-1 text-right",children:"Top Artists of the Week"})]})}),(0,t.jsx)("div",{className:"pl-2 md:pl-4 pr-2 cursor-pointer",onClick:function(){return v()},children:">"})]}),(0,t.jsx)("div",{className:"flex flex-1 items-center overflow-hidden",children:(0,t.jsxs)(o,{itemsToShow:1,childrenLength:2,ref:h,children:[(0,t.jsx)("div",{className:"grid grid-rows-2 grid-cols-2 gap-2 flex-1",children:i.map(function(e,l){return(0,t.jsxs)(x(),{className:"relative group",href:e.track.url,target:"_blank",children:[(0,t.jsx)("img",{src:e.track.image[2]["#text"],width:"100%",height:"100%",className:"group-hover:opacity-50"}),(0,t.jsxs)("div",{className:"hidden absolute group-hover:flex top-0 right-0 text-xs text-grey-800 bg-grey-300 p-1",children:["Played: ",e.rank.playcount," times in the last week"]}),(0,t.jsxs)("div",{className:"absolute bottom-0 right-0 flex flex-col p-2 w-full bg-grey-300/90 group-hover:underline group-hover:decoration-coral-400",children:[(0,t.jsx)("div",{children:e.track.name}),(0,t.jsx)("div",{className:"text-xs text-white",children:e.track.artist.name})]})]},"".concat(l,"-").concat(e.track.mbid))})}),(0,t.jsx)("div",{className:"flex overflow-y-scroll h-full no-scrollbar flex-1",children:(0,t.jsx)("div",{className:"flex flex-col gap-1 w-full",children:n.map(function(e,l){return(0,t.jsxs)("div",{className:"flex w-full p-2 gap-4 items-center",children:[(0,t.jsxs)("div",{className:"w-6",children:[l+1,"."]}),(0,t.jsxs)(x(),{className:"flex w-full items-center",href:e.url,target:"_blank",children:[(0,t.jsx)("div",{className:"flex-1",children:e.name}),(0,t.jsxs)("div",{className:"flex-1 text-xs text-white text-right",children:["played ",e.playcount," times"]})]},l)]},"".concat(l,"-").concat(e.name))})})})]})})]})},h=function(){var e=(0,d.q)(),l=e.init,n=e.latestTracks;return(0,r.useEffect)(function(){l()},[]),(0,t.jsx)("div",{className:"flex h-full p-8 overflow-scroll md:overflow-hidden",children:(0,t.jsxs)("div",{className:"flex flex-col gap-2 w-full",children:[(0,t.jsxs)("section",{className:"flex flex-col gap-4",children:[(0,t.jsx)("h4",{children:(0,t.jsx)(x(),{href:"/",children:"@jz-dot-meng"})}),(0,t.jsxs)("div",{className:"flex items-start flex-col gap-1 md:items-end md:flex-row",children:[(0,t.jsx)("h1",{children:"recently listened"}),(0,t.jsx)("span",{className:"pb-2",children:" :: deep dive into my music tastes"})]})]}),(0,t.jsxs)("section",{className:"py-4 md:py-8 flex flex-col md:flex-row gap-4 md:overflow-hidden",children:[(0,t.jsxs)("div",{className:"flex md:flex-[2] flex-col gap-1 overflow-hidden max-h-80 md:max-h-full",children:[(0,t.jsxs)("div",{className:"flex gap-1 p-2 border-b border-white text-sm",children:[(0,t.jsx)("div",{className:"flex-1 flex items-center"}),(0,t.jsx)("div",{className:"flex-[2] flex items-center",children:"Name & Album"}),(0,t.jsx)("div",{className:"flex-1 flex items-center",children:"Artist"}),(0,t.jsx)("div",{className:"flex-1 flex items-center",children:"Last listened"})]}),(0,t.jsx)("div",{className:"flex flex-col gap-1 overflow-y-scroll no-scrollbar",children:n.map(function(e,l){return(0,t.jsx)(i,{track:e},"".concat(l,"-").concat(e.mbid))})})]}),(0,t.jsx)("div",{className:"flex flex-col flex-1 max-h-80 md:max-h-full overflow-hidden",children:(0,t.jsx)(u,{})})]})]})})}}},function(e){e.O(0,[894,774,888,179],function(){return e(e.s=2802)}),_N_E=e.O()}]);